!function(){var e={Vue:{},music:{}};e.Vue.el="#js-vue",e.Vue.methods={},e.Vue.watch={},e.Vue.data={},e.Vue.data.items=[],e.music.methods={},e.music._songs=[],e.music.player={},e.music.titles=["","十二音平均律→バークリー・メソッド→MIDIを経由する近・現代商業音楽史","ジャズにおいてモダンとは何か？","モダンとプレ・モダン","1950年代のアメリカと、ジャズ・モダニズムの結晶化","1959 〜 1962年におけるジャズの変化 (1) ","1959 〜 1962年におけるジャズの変化 (2) ","フリー・ジャズとは何からのフリーだったのか？","1965 〜 1975年のマイルズ・デイヴィス (1)  コーダル・モーダルとフアンク","1965 〜 1975年のマイルス・デイヴィス (2)  電化と磁化","MIDIとモダニズムの終焉","前期テスト"],e.music.autoplay=!0,e.music.sortby="songID",e.music.filterby="all",e.music.nowplaying={songID:null,state:"stop"},document.querySelector('[isAutoplay="true"]').classList.add("type-active"),document.querySelector('[sortby="'+e.music.sortby+'"]').classList.add("type-active"),document.querySelector('[filterby="'+e.music.filterby+'"]').classList.add("type-active"),e.Vue.created=function(){var t=new XMLHttpRequest;t.onload=function(){e.music._songs=JSON.parse(t.responseText),e.Vue.data.items=e.music._songs.map(function(t,s){var o=t.discogsID.replace("r","release/").replace("m","master/");return t.discogsURL="https://www.discogs.com/"+o,t.state="stop",t.songID=s,t.chapterTitle=e.music.titles[t.chapter],t})},t.open("GET","resources/js/songs.min.json",!0),t.send(),document.getElementsByClassName("m-songs__inner")[0].classList.add("type-active")},e.Vue.methods.sort=function(t,s){e.Vue.data.items=t.slice().sort(function(e,t){return e[s]<t[s]?-1:e[s]>t[s]?1:0})},e.Vue.methods.onClickSort=function(t){e.music.sortby=t.currentTarget.getAttribute("sortby");var s=document.querySelectorAll(".type-sort .type-active");Object.keys(s).forEach(function(e){s[e].classList.remove("type-active")},s),t.currentTarget.classList.add("type-active"),e.Vue.methods.sort(e.Vue.data.items,e.music.sortby)},e.Vue.methods.onClickFilter=function(t){e.music.filterby=t.currentTarget.getAttribute("filterby");var s=document.querySelectorAll(".type-filter .type-active");Object.keys(s).forEach(function(e){s[e].classList.remove("type-active")},s),t.currentTarget.classList.add("type-active"),"all"==e.music.filterby?e.Vue.data.items=e.music._songs:e.Vue.data.items=e.music._songs.filter(function(t){return e.music.filterby==t.chapter}),e.Vue.data.items.map(function(t){return t.songID==e.music.nowplaying.songID?t.state=e.music.nowplaying.state:t.state="stop",t}),e.Vue.methods.sort(e.Vue.data.items,e.music.sortby),document.getElementById("js-searchby").value=""},e.Vue.methods.toggleAutoplay=function(t){var s=document.querySelectorAll(".type-autoplay .type-active");Object.keys(s).forEach(function(e){s[e].classList.remove("type-active")},s),t.currentTarget.classList.add("type-active"),e.music.autoplay="true"==t.currentTarget.getAttribute("isAutoplay")},e.Vue.methods.onChangeSearch=function(t){if("input"==t.type){var s=t.target.value.replace(/[&'`"<>]/g,""),o=new RegExp(s,"i"),u=e.music._songs.filter(function(e){if(e.leader.match(o)||e.title.match(o)||e.album.match(o))return e});e.Vue.methods.sort(u,e.music.sortby),"all"!=e.music.filterby&&(document.querySelector(".type-active[filterby]").classList.remove("type-active"),document.querySelector("[filterby]").classList.add("type-active"),e.music.filterby="all")}},e.Vue.methods.toggleAboutContent=function(e){var t=document.getElementById("js-about");switch(e){case"open":t.classList.add("type-open");break;default:t.classList.remove("type-open")}},e.Vue.methods.toggleHamburger=function(){var e=document.getElementsByClassName("p-home l-home")[0];e.classList.contains("type-nav-open")?e.classList.remove("type-nav-open"):e.classList.add("type-nav-open")},e.Vue.methods.onClickPlay=function(t){if(t.currentTarget.getAttribute("songID")==e.music.nowplaying.songID)switch(e.music.nowplaying.state){case"play":e.music.methods.pause();break;case"pause":e.music.methods.reStart()}else e.music.methods.start(t)},e.music.methods.start=function(t){e.music.methods.setNowplaying(t.currentTarget.getAttribute("songID"),"play"),e.music.methods.createYoutube(t.currentTarget.getAttribute("youtubeID"))},e.music.methods.pause=function(){e.music.player.pauseVideo(),e.music.methods.setNowplaying(e.music.nowplaying.songID,"pause")},e.music.methods.reStart=function(){e.music.player.playVideo(),e.music.methods.setNowplaying(e.music.nowplaying.songID,"play")},e.music.methods.stop=function(){document.getElementById("js-frame").innerHTML="","object"==typeof e.music.player&&"destroy"in e.music.player&&e.music.player.destroy(),e.music.player={},e.music.methods.setNowplaying(null,"stop")},e.music.methods.getNowplaying=function(){return e.music.nowplaying},e.music.methods.setNowplaying=function(t,s){e.music.nowplaying.songID=t,e.music.nowplaying.state=s,e.Vue.data.items.map(function(t){return t.songID==e.music.nowplaying.songID?t.state=s:t.state="stop",t}),document.getElementById("js-frame").setAttribute("state",s)},e.music.methods.createYoutube=function(t){if(""!=t){document.getElementById("js-frame").innerHTML="","object"==typeof e.music.player&&"destroy"in e.music.player&&e.music.player.destroy(),e.music.player={};var s={videoId:t,playerVars:{autoplay:1,playsinline:1},events:{onReady:e.music.methods.onYoutubeReady,onStateChange:e.music.methods.onYoutubeStateChange,onError:e.music.methods.onYoutubeError}};e.music.player=new YT.Player("js-frame",s)}else e.music.methods.stop()},e.music.methods.onYoutubeReady=function(e){console.log("onYoutubeReady(): "+e.target.getVideoData().video_id),e.target.playVideo()},e.music.methods.onYoutubeStateChange=function(t){if(0==t.data){var s,o=e.Vue.data.items.map(function(t){return t.songID==e.music.nowplaying.songID});-1!=o.indexOf(!0)&&(s=e.Vue.data.items[o.indexOf(!0)+1]),e.music.autoplay&&void 0!=s&&""!=s.youtubeID?(e.music.methods.createYoutube(s.youtubeID),e.music.methods.setNowplaying(s.songID,"play")):e.music.methods.stop()}},e.music.methods.onYoutubeError=function(t){e.music.methods.stop(),console.log("onYoutubeError"),console.log(t),alert("Youtube の設定により再生に失敗しました。 Error code: "+t.data)},new Vue(e.Vue)}();